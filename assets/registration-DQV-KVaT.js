import{v as E,a as y,b as S,c as v,d as h}from"./validation-CcaYfggc.js";import{f as g}from"./fetcher-IzjmCLXP.js";const o=document.querySelector("#registration-form"),d=o?.querySelector("#login"),l=o?.querySelector("#password"),i=o?.querySelector("#confirm-password"),s=o?.querySelector("#city"),a=o?.querySelector("#street"),m=o?.querySelector("#houseNumber"),w=document.querySelectorAll('input[name="paymentMethod"]'),f=o?.querySelector("#login-btn");if(!(o instanceof HTMLFormElement)||!(d instanceof HTMLInputElement)||!(l instanceof HTMLInputElement)||!(i instanceof HTMLInputElement)||!(s instanceof HTMLSelectElement)||!(a instanceof HTMLSelectElement)||!(m instanceof HTMLInputElement)||w.length===0||!(f instanceof HTMLButtonElement))throw new Error("Registration form elements not found");async function b(){return await(await fetch("assets/cities.json")).json()}function C(e){Object.keys(e).forEach(n=>{const t=document.createElement("option");t.value=n,t.textContent=n,s?.appendChild(t)})}function M(e){a.innerHTML="";const n=document.createElement("option");n.value="",n.textContent="Select street",n.disabled=!0,n.selected=!0,a.appendChild(n),e&&e.map(t=>{const r=document.createElement("option");r.value=t,r.textContent=t,a?.append(r)})}const L=await b();C(L);s?.addEventListener("change",()=>{const e=s.value;M(L[e]||null)});f.disabled=!0;function u(e,n){const t=e.nextElementSibling;if(!(t instanceof HTMLSpanElement)||!t)throw new Error("Error span not found");e.addEventListener("blur",()=>{const r=n(e.value);r?(e.classList.add("invalid"),t.textContent=r,t.classList.add("active")):e.classList.add("valid"),T()}),e.addEventListener("focus",()=>{e.classList.remove("invalid"),e.classList.remove("valid"),t.textContent="",t.classList.remove("active")})}function T(){if(!d||!l||!i||!s||!a||!m||!f)return;const e=E(d.value),n=y(l.value),t=S(l.value,i.value),r=v(s.value),c=v(a.value),p=h(m.value);f.disabled=!!e||!!n||!!t||!!r||!!c||!!p}u(d,E);u(l,y);u(i,()=>S(l.value,i.value));u(a,v);u(s,v);u(m,h);f.addEventListener("click",async e=>{e.preventDefault(),o.querySelector(".alert-error")&&o.querySelector(".alert-error")?.remove();const n={login:d.value,password:l.value,confirmPassword:i.value,city:s.value,street:a.value,houseNumber:Number(m.value),paymentMethod:String(Array.from(w).find(p=>p.checked)?.value)||""},{data:t,error:r}=await g("https://6kt29kkeub.execute-api.eu-central-1.amazonaws.com/auth/register","#loader",{method:"POST",body:n}),c=document.createElement("div");c.className="alert-error",r&&(c.textContent="Incorrect login or password",o.append(c)),t&&(c.textContent="Registration successful! You can now sign in.",o.append(c),setTimeout(()=>{window.location.href="/login"},3e3))});
//# sourceMappingURL=registration-DQV-KVaT.js.map
