import{v as f,a as p,b as E,c as v,d as h}from"./validation-DBJCbEPH.js";import{b as L,d as b,c as C}from"./firebase-CxVZMhw8.js";import{r as M}from"./auth-DGodpPl6.js";const o=document.querySelector("#registration-form"),i=o?.querySelector("#login"),l=o?.querySelector("#password"),d=o?.querySelector("#confirm-password"),s=o?.querySelector("#city"),a=o?.querySelector("#street"),u=o?.querySelector("#houseNumber"),y=document.querySelectorAll('input[name="paymentMethod"]'),m=o?.querySelector("#login-btn");if(!(o instanceof HTMLFormElement)||!(i instanceof HTMLInputElement)||!(l instanceof HTMLInputElement)||!(d instanceof HTMLInputElement)||!(s instanceof HTMLSelectElement)||!(a instanceof HTMLSelectElement)||!(u instanceof HTMLInputElement)||y.length===0||!(m instanceof HTMLButtonElement))throw new Error("Registration form elements not found");async function T(){return await(await fetch("assets/cities.json")).json()}function q(t){Object.keys(t).forEach(n=>{const e=document.createElement("option");e.value=n,e.textContent=n,s?.appendChild(e)})}function x(t){a.innerHTML="";const n=document.createElement("option");n.value="",n.textContent="Select street",n.disabled=!0,n.selected=!0,a.appendChild(n),t&&t.map(e=>{const r=document.createElement("option");r.value=e,r.textContent=e,a?.append(r)})}const w=await T();q(w);s?.addEventListener("change",()=>{const t=s.value;x(w[t]||null)});m.disabled=!0;function c(t,n){const e=t.nextElementSibling;if(!(e instanceof HTMLSpanElement)||!e)throw new Error("Error span not found");t.addEventListener("blur",()=>{const r=n(t.value);r?(t.classList.add("invalid"),e.textContent=r,e.classList.add("active")):t.classList.add("valid"),H()}),t.addEventListener("focus",()=>{t.classList.remove("invalid"),t.classList.remove("valid"),e.textContent="",e.classList.remove("active")})}function H(){if(!i||!l||!d||!s||!a||!u||!m)return;const t=f(i.value),n=p(l.value),e=E(l.value,d.value),r=v(s.value),S=v(a.value),g=h(u.value);m.disabled=!!t||!!n||!!e||!!r||!!S||!!g}c(i,f);c(l,p);c(d,()=>E(l.value,d.value));c(a,v);c(s,v);c(u,h);m.addEventListener("click",async t=>{t.preventDefault(),o.querySelector(".alert-error")&&o.querySelector(".alert-error")?.remove();try{const n=await M(i.value,l.value);await L(b(C,"users",n.uid),{login:i.value,city:s.value,street:a.value,houseNumber:Number(u.value),paymentMethod:Array.from(y).find(r=>r.checked)?.value||"",createdAt:new Date().toISOString()});const e=document.createElement("div");e.className="alert-success",e.textContent="Registration successful! You can now sign in.",o.append(e),setTimeout(()=>{window.location.href="/login"},3e3)}catch(n){console.error(n);const e=document.createElement("div");e.className="alert-error",n.code==="auth/email-already-in-use"?e.textContent="This email is already registered.":n.code==="auth/invalid-email"?e.textContent="Invalid email format.":n.code==="auth/weak-password"?e.textContent="Password should be at least 6 characters.":e.textContent="Registration failed. Try again later.",o.append(e)}});
//# sourceMappingURL=registration-C09hDksr.js.map
