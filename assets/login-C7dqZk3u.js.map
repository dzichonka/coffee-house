{"version":3,"file":"login-C7dqZk3u.js","sources":["../../src/scripts/utils/validateEnglishLetters.ts","../../src/scripts/utils/login.ts"],"sourcesContent":["export function validateEnglishLetters(value: string): boolean {\n  const letters = value.match(/\\p{L}/gu);\n  if (!letters) return true;\n  return letters.every((l) => /^[A-Za-z]$/.test(l));\n}\n","import { validateEnglishLetters } from \"./validateEnglishLetters\";\nimport { fetcher } from \"./fetcher\";\n\nconst form: HTMLFormElement | null = document.querySelector(\"#login-form\");\nconst loginInput: HTMLInputElement | null = document.querySelector(\"#login\");\nconst passwordInput: HTMLInputElement | null =\n  document.querySelector(\"#password\");\nconst loginButton: HTMLButtonElement | null =\n  document.querySelector(\"#login-btn\");\n\nif (!form || !loginInput || !passwordInput || !loginButton) {\n  throw new Error(\"Login form elements not found\");\n}\n\nloginButton.disabled = true;\n\nfunction validateLogin(value: string): string | null {\n  if (value.length < 3) return \"Login must be at least 3 characters\";\n  if (!validateEnglishLetters(value)) {\n    return \"Only English letters allowed\";\n  }\n  if (!/^[A-Za-z]/.test(value)) return \"Login must start with a letter\";\n  return null;\n}\n\nfunction validatePassword(value: string): string | null {\n  if (value.length < 6) return \"Password must be at least 6 characters\";\n  // if (!/[!@#$%^&*(),.?\":{}|<>]/.test(value))\n  //   return \"Password must contain a special character\";\n  if (!/\\d/.test(value)) return \"Password must contain a number\";\n  return null;\n}\n\nfunction handleValidation(\n  input: HTMLInputElement,\n  validateFn: (value: string) => string | null,\n) {\n  const errorSpan = input.nextElementSibling;\n\n  if (!(errorSpan instanceof HTMLSpanElement) || !errorSpan) {\n    throw new Error(\"Error span not found\");\n  }\n\n  input.addEventListener(\"blur\", () => {\n    const error = validateFn(input.value);\n    if (error) {\n      input.classList.add(\"invalid\");\n      errorSpan.textContent = error;\n      errorSpan.classList.add(\"active\");\n    } else {\n      input.classList.add(\"valid\");\n    }\n\n    updateButtonState();\n  });\n\n  input.addEventListener(\"focus\", () => {\n    input.classList.remove(\"invalid\");\n    input.classList.remove(\"valid\");\n    errorSpan.textContent = \"\";\n    errorSpan.classList.remove(\"active\");\n  });\n}\n\nfunction updateButtonState() {\n  if (!loginInput || !passwordInput || !loginButton) return;\n  const loginError = validateLogin(loginInput.value);\n  const passwordError = validatePassword(passwordInput.value);\n  loginButton.disabled = !!loginError || !!passwordError;\n}\n\nhandleValidation(loginInput, validateLogin);\nhandleValidation(passwordInput, validatePassword);\n\nloginButton.addEventListener(\"click\", async (e) => {\n  e.preventDefault();\n  if (form.querySelector(\".alert-error\")) {\n    form.querySelector(\".alert-error\")?.remove();\n  }\n  if (!loginInput || !passwordInput) return;\n\n  const payload = {\n    login: loginInput.value,\n    password: passwordInput.value,\n  };\n\n  const { data: res, error } = await fetcher<\n    {\n      data: LoginResponse;\n      message?: string;\n      error?: string;\n    },\n    LoginPayload\n  >(\n    \"https://6kt29kkeub.execute-api.eu-central-1.amazonaws.com/auth/login\",\n    \"#loader\",\n    {\n      method: \"POST\",\n      body: payload,\n    },\n  );\n\n  if (error) {\n    const alert = document.createElement(\"div\");\n    alert.className = \"alert-error\";\n    alert.textContent = `Incorrect login or password`;\n    form.append(alert);\n  }\n  if (res && res.data) {\n    window.location.href = \"index\";\n  }\n});\n"],"names":["validateEnglishLetters","value","letters","l","form","loginInput","passwordInput","loginButton","validateLogin","validatePassword","handleValidation","input","validateFn","errorSpan","error","updateButtonState","loginError","passwordError","payload","res","fetcher","alert"],"mappings":"qCAAO,SAASA,EAAuBC,EAAwB,CAC7D,MAAMC,EAAUD,EAAM,MAAM,wBAAS,GACrC,OAAKC,EACEA,EAAQ,MAAOC,GAAM,aAAa,KAAKA,CAAC,CAAC,EAD3B,EAEvB,CCDA,MAAMC,EAA+B,SAAS,cAAc,aAAa,EACnEC,EAAsC,SAAS,cAAc,QAAQ,EACrEC,EACJ,SAAS,cAAc,WAAW,EAC9BC,EACJ,SAAS,cAAc,YAAY,EAErC,GAAI,CAACH,GAAQ,CAACC,GAAc,CAACC,GAAiB,CAACC,EAC7C,MAAM,IAAI,MAAM,+BAA+B,EAGjDA,EAAY,SAAW,GAEvB,SAASC,EAAcP,EAA8B,CACnD,OAAIA,EAAM,OAAS,EAAU,sCACxBD,EAAuBC,CAAK,EAG5B,YAAY,KAAKA,CAAK,EACpB,KAD8B,iCAF5B,8BAIX,CAEA,SAASQ,EAAiBR,EAA8B,CACtD,OAAIA,EAAM,OAAS,EAAU,yCAGxB,KAAK,KAAKA,CAAK,EACb,KADuB,gCAEhC,CAEA,SAASS,EACPC,EACAC,EACA,CACA,MAAMC,EAAYF,EAAM,mBAExB,GAAI,EAAEE,aAAqB,kBAAoB,CAACA,EAC9C,MAAM,IAAI,MAAM,sBAAsB,EAGxCF,EAAM,iBAAiB,OAAQ,IAAM,CACnC,MAAMG,EAAQF,EAAWD,EAAM,KAAK,EAChCG,GACFH,EAAM,UAAU,IAAI,SAAS,EAC7BE,EAAU,YAAcC,EACxBD,EAAU,UAAU,IAAI,QAAQ,GAEhCF,EAAM,UAAU,IAAI,OAAO,EAG7BI,EAAA,CACF,CAAC,EAEDJ,EAAM,iBAAiB,QAAS,IAAM,CACpCA,EAAM,UAAU,OAAO,SAAS,EAChCA,EAAM,UAAU,OAAO,OAAO,EAC9BE,EAAU,YAAc,GACxBA,EAAU,UAAU,OAAO,QAAQ,CACrC,CAAC,CACH,CAEA,SAASE,GAAoB,CAC3B,GAAI,CAACV,GAAc,CAACC,GAAiB,CAACC,EAAa,OACnD,MAAMS,EAAaR,EAAcH,EAAW,KAAK,EAC3CY,EAAgBR,EAAiBH,EAAc,KAAK,EAC1DC,EAAY,SAAW,CAAC,CAACS,GAAc,CAAC,CAACC,CAC3C,CAEAP,EAAiBL,EAAYG,CAAa,EAC1CE,EAAiBJ,EAAeG,CAAgB,EAEhDF,EAAY,iBAAiB,QAAS,MAAO,GAAM,CAKjD,GAJA,EAAE,eAAA,EACEH,EAAK,cAAc,cAAc,GACnCA,EAAK,cAAc,cAAc,GAAG,OAAA,EAElC,CAACC,GAAc,CAACC,EAAe,OAEnC,MAAMY,EAAU,CACd,MAAOb,EAAW,MAClB,SAAUC,EAAc,KAAA,EAGpB,CAAE,KAAMa,EAAK,MAAAL,CAAA,EAAU,MAAMM,EAQjC,uEACA,UACA,CACE,OAAQ,OACR,KAAMF,CAAA,CACR,EAGF,GAAIJ,EAAO,CACT,MAAMO,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,UAAY,cAClBA,EAAM,YAAc,8BACpBjB,EAAK,OAAOiB,CAAK,CACnB,CACIF,GAAOA,EAAI,OACb,OAAO,SAAS,KAAO,QAE3B,CAAC"}