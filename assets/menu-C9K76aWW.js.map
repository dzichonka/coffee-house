{"version":3,"file":"menu-C9K76aWW.js","sources":["../../src/scripts/utils/modal.ts","../../src/types/typeGuards.ts","../../src/scripts/utils/cards.ts"],"sourcesContent":["import { fetcher } from \"./fetcher\";\n\nconst modal = document.querySelector<HTMLDivElement>(\"#modal\");\nconst content = document.querySelector<HTMLDivElement>(\".window\");\nconst closeBtn = document.querySelector<HTMLButtonElement>(\"#close\");\nconst price = document.querySelector<HTMLHeadingElement>(\"#modal-price\");\nconst img = document.querySelector<HTMLImageElement>(\"#modal-img\");\nconst title = document.querySelector<HTMLHeadingElement>(\"#modal-title\");\nconst description = document.querySelector<HTMLElement>(\"#modal-description\");\n\nconst tabsSize = Array.from(\n  document.querySelectorAll<HTMLDivElement>(\".tab-size\")\n);\nconst tabsAdditives = Array.from(\n  document.querySelectorAll<HTMLElement>(\".tab-add\")\n);\n\nlet sizeListenersAdded = false;\nlet addListenersAdded = false;\nfunction closeModal() {\n  modal?.classList.add(\"closed\");\n  document.body.style.overflow = \"auto\";\n  tabsSize.forEach((tab) => tab.classList.remove(\"active\"));\n  tabsSize[0].classList.add(\"active\");\n  tabsAdditives.forEach((tab) => tab.classList.remove(\"active\"));\n}\n\ncloseBtn?.addEventListener(\"click\", () => {\n  closeModal();\n});\n\nwindow.addEventListener(\"click\", (e: Event): void => {\n  if (e.target === modal && e.target !== content) {\n    closeModal();\n  }\n});\n\nexport async function displayModal(id: number): Promise<void> {\n  const { data: res, error } = await fetcher<{\n    data: FavoriteProduct[];\n    message?: string;\n    error?: string;\n  }>(\n    `https://6kt29kkeub.execute-api.eu-central-1.amazonaws.com/products/${id}`,\n    \"#loader\"\n  );\n\n  if (error || !res?.data || res.data.length === 0) {\n    return;\n  }\n\n  const item = res.data[0];\n\n  let basePrice = Number(item.price);\n  let additivesPrice = 0;\n\n  const updatePrice = (): void => {\n    const total = basePrice + additivesPrice;\n    if (price) price.textContent = `$${total.toFixed(2)}`;\n  };\n\n  if (!modal || !content || !price) return;\n  modal.classList.remove(\"closed\");\n  document.body.style.overflow = \"hidden\";\n\n  if (img) {\n    img.src = `images/menu/${item.category}/${item.id}.png`;\n    img.alt = item.name;\n  }\n  if (title) title.textContent = item.name;\n  if (description) description.textContent = item.description;\n\n  const sizeKeys: SizesType[] = [\"s\", \"m\", \"l\"];\n\n  if (!sizeListenersAdded) {\n    sizeKeys.forEach((key: SizesType, i: number): void => {\n      //const sizeData: SizeType = item.sizes[key];\n      //const span = tabsSize[i].querySelector<HTMLSpanElement>(\".text\");\n      // tabsSize[i].setAttribute(\"data-size\", sizeData[\"add-price\"]);\n      // if (span) span.textContent = sizeData.size;\n\n      tabsSize[i].addEventListener(\"click\", () => {\n        tabsSize.forEach((tab) => {\n          tab.classList.remove(\"active\");\n          basePrice = Number(item.price);\n        });\n        tabsSize[i].classList.add(\"active\");\n        basePrice += Number(tabsSize[i].getAttribute(\"data-size\"));\n        updatePrice();\n      });\n    });\n    sizeListenersAdded = true;\n  }\n\n  if (!addListenersAdded) {\n    // item.additives.forEach((additive, i) => {\n    //   const span = tabsAdditives[i].querySelector(\".text\");\n    //   tabsAdditives[i].setAttribute(\"data-add\", additive[\"add-price\"]);\n    //   if (span) span.textContent = additive.name;\n\n    //   tabsAdditives[i].addEventListener(\"click\", () => {\n    //     tabsAdditives[i].classList.toggle(\"active\");\n    //     if (tabsAdditives[i].classList.contains(\"active\")) {\n    //       additivesPrice += Number(tabsAdditives[i].getAttribute(\"data-add\"));\n    //     } else {\n    //       additivesPrice -= Number(tabsAdditives[i].getAttribute(\"data-add\"));\n    //     }\n    //     updatePrice();\n    //   });\n    // });\n    addListenersAdded = true;\n  }\n\n  updatePrice();\n}\n","export function isCategoryType(value: string): value is CategoryType {\n  return [\"coffee\", \"tea\", \"dessert\"].includes(value);\n}\n\nexport function isSizesType(value: string): value is SizesType {\n  return [\"s\", \"m\", \"l\"].includes(value);\n}\n","import { displayModal } from \"./modal\";\nimport { isCategoryType } from \"@/types/typeGuards\";\nimport { fetcher } from \"./fetcher\";\n\nconst wrapper: HTMLDivElement | null = document.querySelector(\".cards\");\nconst tabs: HTMLDivElement[] = Array.from(\n  document.querySelectorAll(\".tab-category\")\n);\nconst refresh: HTMLButtonElement | null = document.querySelector(\"#refresh\");\n\nlet currentCategory: CategoryType = \"coffee\";\n\nconst isMobile = () => window.innerWidth <= 768;\n\n// async function fetchCards(): Promise<ProductsType> {\n//   const response = await fetch(\"assets/products.json\");\n//   return await response.json();\n// }\n\nconst { data: res, error } = await fetcher<{\n  data: FavoriteProduct[];\n  message?: string;\n  error?: string;\n}>(\n  \"https://6kt29kkeub.execute-api.eu-central-1.amazonaws.com/products\",\n  \"#loader\"\n);\n\nif (error) {\n  if (wrapper) wrapper.innerHTML = \"<p>Failed to load products.</p>\";\n}\n\nconst products = res?.data ?? [];\n\nconsole.log(\"Products loaded:\", products);\n\nlet visibleCount: number = isMobile() ? 4 : 8;\n\nfunction displayCards(category: CategoryType) {\n  if (!wrapper) return;\n  wrapper.innerHTML = \"\";\n  const cards = products.filter((product) => product.category === category);\n  const visibleCards = cards.slice(0, visibleCount);\n\n  visibleCards.forEach((card: ProductType): void => {\n    const cardElement: HTMLDivElement = document.createElement(\"div\");\n    cardElement.classList.add(\"card\");\n    cardElement.innerHTML = `\n      <div class=\"image-container\">\n        <img\n          src=\"images/menu/${card.id}.png\"\n          alt=\"${card.name}\"\n        />\n      </div>\n      <div class=\"description-container\">\n        <div class=\"description\">\n          <h3>${card.name}</h3>\n          <p>${card.description}</p>\n        </div>\n      </div>\n        <div class=\"price-container\">\n          <h3>$${card.price}</h3>\n        </div>\n      </div>\n    `;\n    wrapper.append(cardElement);\n\n    cardElement.addEventListener(\"click\", (): void => {\n      displayModal(card.id);\n    });\n  });\n\n  function checkRefreshVisibility() {\n    if (!refresh) return;\n    if (cards.length > visibleCards.length) {\n      refresh.classList.remove(\"hidden\");\n    } else {\n      refresh.classList.add(\"hidden\");\n    }\n  }\n  checkRefreshVisibility();\n}\n\ntabs.forEach((tab) => {\n  tab.addEventListener(\"click\", (): void => {\n    tabs.forEach((t) => t.classList.remove(\"active\"));\n    tab.classList.add(\"active\");\n    visibleCount = isMobile() ? 4 : 8;\n\n    const tabValue = tab.dataset.tab;\n    if (!tabValue || !isCategoryType(tabValue)) return;\n    currentCategory = tabValue;\n    displayCards(currentCategory);\n  });\n});\n\nrefresh?.addEventListener(\"click\", () => {\n  visibleCount += 4;\n  displayCards(currentCategory);\n});\n\nlet lastIsMobile = isMobile();\nwindow.addEventListener(\"resize\", (): void => {\n  const nowIsMobile = isMobile();\n  if (nowIsMobile !== lastIsMobile) {\n    displayCards(currentCategory);\n    lastIsMobile = nowIsMobile;\n  }\n});\n\ndisplayCards(currentCategory);\n"],"names":["modal","content","closeBtn","price","img","title","description","tabsSize","tabsAdditives","sizeListenersAdded","closeModal","tab","displayModal","id","res","error","fetcher","item","basePrice","additivesPrice","updatePrice","total","key","i","isCategoryType","value","wrapper","tabs","refresh","currentCategory","isMobile","products","visibleCount","displayCards","category","cards","product","visibleCards","card","cardElement","checkRefreshVisibility","t","tabValue","lastIsMobile","nowIsMobile"],"mappings":"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"}