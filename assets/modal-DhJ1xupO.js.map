{"version":3,"file":"modal-DhJ1xupO.js","sources":["../../src/scripts/modules/modal.ts"],"sourcesContent":["import { fetcher } from \"../utils/fetcher\";\n\nconst modal = document.querySelector<HTMLDivElement>(\"#modal\");\nconst content = document.querySelector<HTMLDivElement>(\".window\");\nconst closeBtn = document.querySelector<HTMLButtonElement>(\"#close\");\nconst price = document.querySelector<HTMLHeadingElement>(\"#modal-price\");\nconst img = document.querySelector<HTMLImageElement>(\"#modal-img\");\nconst title = document.querySelector<HTMLHeadingElement>(\"#modal-title\");\nconst description = document.querySelector<HTMLElement>(\"#modal-description\");\n\nconst tabsSize = Array.from(\n  document.querySelectorAll<HTMLDivElement>(\".tab-size\")\n);\nconst tabsAdditives = Array.from(\n  document.querySelectorAll<HTMLElement>(\".tab-add\")\n);\n\nlet sizeListenersAdded = false;\nlet addListenersAdded = false;\nfunction closeModal() {\n  modal?.classList.add(\"closed\");\n  document.body.style.overflow = \"auto\";\n  tabsSize.forEach((tab) => tab.classList.remove(\"active\"));\n  tabsSize[0].classList.add(\"active\");\n  tabsAdditives.forEach((tab) => tab.classList.remove(\"active\"));\n}\n\ncloseBtn?.addEventListener(\"click\", () => {\n  closeModal();\n});\n\nwindow.addEventListener(\"click\", (e: Event): void => {\n  if (e.target === modal && e.target !== content) {\n    closeModal();\n  }\n});\n\nexport async function displayModal(id: number): Promise<void> {\n  const { data: res, error } = await fetcher<{\n    data: FavoriteProduct[];\n    message?: string;\n    error?: string;\n  }>(\n    `https://6kt29kkeub.execute-api.eu-central-1.amazonaws.com/products/${id}`,\n    \"#loader\"\n  );\n\n  if (error || !res?.data || res.data.length === 0) {\n    return;\n  }\n\n  const item = res.data[0];\n\n  let basePrice = Number(item.price);\n  let additivesPrice = 0;\n\n  const updatePrice = (): void => {\n    const total = basePrice + additivesPrice;\n    if (price) price.textContent = `$${total.toFixed(2)}`;\n  };\n\n  if (!modal || !content || !price) return;\n  modal.classList.remove(\"closed\");\n  document.body.style.overflow = \"hidden\";\n\n  if (img) {\n    img.src = `images/menu/${item.category}/${item.id}.png`;\n    img.alt = item.name;\n  }\n  if (title) title.textContent = item.name;\n  if (description) description.textContent = item.description;\n\n  // const sizeKeys: SizesType[] = [\"s\", \"m\", \"l\"];\n\n  if (!sizeListenersAdded) {\n    // sizeKeys.forEach((key: SizesType, i: number): void => {\n    //   //const sizeData: SizeType = item.sizes[key];\n    //   //const span = tabsSize[i].querySelector<HTMLSpanElement>(\".text\");\n    //   // tabsSize[i].setAttribute(\"data-size\", sizeData[\"add-price\"]);\n    //   // if (span) span.textContent = sizeData.size;\n\n    //   tabsSize[i].addEventListener(\"click\", () => {\n    //     tabsSize.forEach((tab) => {\n    //       tab.classList.remove(\"active\");\n    //       basePrice = Number(item.price);\n    //     });\n    //     tabsSize[i].classList.add(\"active\");\n    //     basePrice += Number(tabsSize[i].getAttribute(\"data-size\"));\n    //     updatePrice();\n    //   });\n    // });\n    sizeListenersAdded = true;\n  }\n\n  if (!addListenersAdded) {\n    // item.additives.forEach((additive, i) => {\n    //   const span = tabsAdditives[i].querySelector(\".text\");\n    //   tabsAdditives[i].setAttribute(\"data-add\", additive[\"add-price\"]);\n    //   if (span) span.textContent = additive.name;\n\n    //   tabsAdditives[i].addEventListener(\"click\", () => {\n    //     tabsAdditives[i].classList.toggle(\"active\");\n    //     if (tabsAdditives[i].classList.contains(\"active\")) {\n    //       additivesPrice += Number(tabsAdditives[i].getAttribute(\"data-add\"));\n    //     } else {\n    //       additivesPrice -= Number(tabsAdditives[i].getAttribute(\"data-add\"));\n    //     }\n    //     updatePrice();\n    //   });\n    // });\n    addListenersAdded = true;\n  }\n\n  updatePrice();\n}\n"],"names":["modal","content","closeBtn","price","img","title","description","tabsSize","tabsAdditives","closeModal","tab","displayModal","id","res","error","fetcher","item","basePrice","additivesPrice","updatePrice","total"],"mappings":"0CAEA,MAAMA,EAAQ,SAAS,cAA8B,QAAQ,EACvDC,EAAU,SAAS,cAA8B,SAAS,EAC1DC,EAAW,SAAS,cAAiC,QAAQ,EAC7DC,EAAQ,SAAS,cAAkC,cAAc,EACjEC,EAAM,SAAS,cAAgC,YAAY,EAC3DC,EAAQ,SAAS,cAAkC,cAAc,EACjEC,EAAc,SAAS,cAA2B,oBAAoB,EAEtEC,EAAW,MAAM,KACrB,SAAS,iBAAiC,WAAW,CACvD,EACMC,EAAgB,MAAM,KAC1B,SAAS,iBAA8B,UAAU,CACnD,EAIA,SAASC,GAAa,CACpBT,GAAO,UAAU,IAAI,QAAQ,EAC7B,SAAS,KAAK,MAAM,SAAW,OAC/BO,EAAS,QAASG,GAAQA,EAAI,UAAU,OAAO,QAAQ,CAAC,EACxDH,EAAS,CAAC,EAAE,UAAU,IAAI,QAAQ,EAClCC,EAAc,QAASE,GAAQA,EAAI,UAAU,OAAO,QAAQ,CAAC,CAC/D,CAEAR,GAAU,iBAAiB,QAAS,IAAM,CACxCO,EAAA,CACF,CAAC,EAED,OAAO,iBAAiB,QAAU,GAAmB,CAC/C,EAAE,SAAWT,GAAS,EAAE,SAAWC,GACrCQ,EAAA,CAEJ,CAAC,EAED,eAAsBE,EAAaC,EAA2B,CAC5D,KAAM,CAAE,KAAMC,EAAK,MAAAC,CAAA,EAAU,MAAMC,EAKjC,sEAAsEH,CAAE,GACxE,SAAA,EAGF,GAAIE,GAAS,CAACD,GAAK,MAAQA,EAAI,KAAK,SAAW,EAC7C,OAGF,MAAMG,EAAOH,EAAI,KAAK,CAAC,EAEvB,IAAII,EAAY,OAAOD,EAAK,KAAK,EAC7BE,EAAiB,EAErB,MAAMC,EAAc,IAAY,CAC9B,MAAMC,EAAQH,EAAYC,EACtBf,IAAOA,EAAM,YAAc,IAAIiB,EAAM,QAAQ,CAAC,CAAC,GACrD,EAEI,CAACpB,GAAS,CAACC,GAAW,CAACE,IAC3BH,EAAM,UAAU,OAAO,QAAQ,EAC/B,SAAS,KAAK,MAAM,SAAW,SAE3BI,IACFA,EAAI,IAAM,eAAeY,EAAK,QAAQ,IAAIA,EAAK,EAAE,OACjDZ,EAAI,IAAMY,EAAK,MAEbX,IAAOA,EAAM,YAAcW,EAAK,MAChCV,IAAaA,EAAY,YAAcU,EAAK,aA2ChDG,EAAA,EACF"}