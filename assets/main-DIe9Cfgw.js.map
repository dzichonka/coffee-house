{"version":3,"file":"main-DIe9Cfgw.js","sources":["../../src/scripts/utils/fetcher.ts","../../src/scripts/utils/slider.ts"],"sourcesContent":["interface ApiResponse<T> {\n  data?: T | null;\n  message?: string | null;\n  error?: string | null;\n}\nexport async function fetcher<T>(\n  url: string,\n  loaderId: string\n): Promise<ApiResponse<T>> {\n  const loader = document.querySelector<HTMLDivElement>(loaderId);\n  if (loader) loader.classList.add(\"active\");\n\n  try {\n    const res = await fetch(url);\n\n    if (!res.ok) {\n      return { data: null, error: `HTTP error: ${res.status}` };\n    }\n\n    const json = (await res.json()) as T;\n\n    return { data: json, error: null };\n  } catch (err) {\n    console.error(\"Fetch error:\", err);\n    return { data: null, error: \"Failed to fetch data\" };\n  } finally {\n    if (loader) loader.classList.remove(\"active\");\n  }\n}\n","import { fetcher } from \"./fetcher\";\n\nconst slideWrapper = document.querySelector<HTMLDivElement>(\".slider-wrapper\");\nconst wrapper = document.querySelector<HTMLDivElement>(\".wrapper\");\nconst sliderDiv = document.querySelector<HTMLDivElement>(\".slider\");\nconst dotsContainer = document.querySelector<HTMLDivElement>(\".dots\");\n\nconst prev = document.querySelector<HTMLButtonElement>(\".prev\");\nconst next = document.querySelector<HTMLButtonElement>(\".next\");\n\nconst errorDiv = document.querySelector<HTMLDivElement>(\"#error\");\nconst refreshButton = document.querySelector<HTMLButtonElement>(\"#refresh\");\n\nexport async function initSlider(): Promise<void> {\n  if (!slideWrapper || !dotsContainer) return;\n\n  slideWrapper!.innerHTML = \"\";\n  dotsContainer!.innerHTML = \"\";\n\n  const { data: res, error } = await fetcher<{\n    data: FavoriteProduct[];\n    message?: string;\n    error?: string;\n  }>(\n    \"http://coffee-shop-be.eu-central-1.elasticbeanstalk.com/products/favorites\",\n    \"#loader\"\n  );\n\n  if (error) {\n    if (sliderDiv) sliderDiv.style.display = \"none\";\n    if (dotsContainer) dotsContainer.style.display = \"none\";\n    if (errorDiv) errorDiv.style.display = \"flex\";\n\n    return;\n  }\n\n  const slides = res?.data ?? [];\n\n  slides.forEach((slide, index) => {\n    const div = document.createElement(\"div\");\n    div.classList.add(\"slide\");\n    if (index === 0) div.classList.add(\"active\");\n\n    div.innerHTML = `\n      <img src=\"images/favourites/${slide.id}.png\" alt=\"${slide.name}\">\n      <h3>${slide.name}</h3>\n      <p>${slide.description}</p>\n      <h3>$${slide.price}</h3>\n    `;\n\n    slideWrapper.appendChild(div);\n\n    const dot = document.createElement(\"div\");\n    dot.classList.add(\"dot\");\n    dot.appendChild(document.createElement(\"span\"));\n    dotsContainer.appendChild(dot);\n  });\n\n  const slidesArray = Array.from(\n    document.querySelectorAll<HTMLDivElement>(\".slide\")\n  );\n  const dots = Array.from(\n    dotsContainer.querySelectorAll<HTMLDivElement>(\".dot\")\n  );\n\n  let currentIndex = 0;\n  let autoScrollDelay = 5000;\n  let autoScrollTimer: null | ReturnType<typeof setTimeout> = null;\n\n  let progressRAF: number | null = null;\n  let progressStartTime: number | null = null;\n  let progressElapsed = 0;\n\n  function updateProgress(dot: Element): void {\n    const bar = dot.querySelector<HTMLSpanElement>(\"span\");\n    if (!dot) return;\n    if (progressRAF) cancelAnimationFrame(progressRAF);\n\n    function step(timestamp: number): void {\n      if (!bar) {\n        return;\n      }\n      if (!progressStartTime) progressStartTime = timestamp;\n      const delta = timestamp - progressStartTime + progressElapsed;\n      const percent = Math.min((delta / autoScrollDelay) * 100, 100);\n      if (bar) bar.style.width = percent + \"%\";\n\n      if (percent < 100) {\n        progressRAF = requestAnimationFrame(step);\n      } else {\n        progressStartTime = null;\n        progressElapsed = 0;\n        progressStartTime = null;\n      }\n    }\n    progressRAF = requestAnimationFrame(step);\n  }\n\n  function stopProgress(): void {\n    if (progressRAF) cancelAnimationFrame(progressRAF);\n    if (progressStartTime) {\n      progressElapsed += performance.now() - progressStartTime;\n    }\n    progressStartTime = null;\n  }\n\n  function resetProgress(): void {\n    if (progressRAF) cancelAnimationFrame(progressRAF);\n    dots.forEach((d) => {\n      const span = d.querySelector(\"span\");\n      if (span) span.style.width = \"0%\";\n    });\n    progressElapsed = 0;\n    progressStartTime = null;\n  }\n\n  function showSlide(index: number): void {\n    slidesArray.forEach((s, i) => s.classList.toggle(\"active\", i === index));\n\n    resetProgress();\n    updateProgress(dots[index]);\n  }\n\n  function startAutoScroll() {\n    stopAutoScroll();\n    autoScrollTimer = setTimeout(() => {\n      currentIndex = (currentIndex + 1) % slides.length;\n      showSlide(currentIndex);\n      startAutoScroll();\n    }, autoScrollDelay - progressElapsed);\n  }\n\n  function stopAutoScroll(): void {\n    if (autoScrollTimer) clearTimeout(autoScrollTimer);\n  }\n\n  prev?.addEventListener(\"click\", (): void => {\n    currentIndex = (currentIndex - 1 + slides.length) % slides.length;\n    showSlide(currentIndex);\n    startAutoScroll();\n  });\n\n  next?.addEventListener(\"click\", () => {\n    currentIndex = (currentIndex + 1) % slides.length;\n    showSlide(currentIndex);\n    startAutoScroll();\n  });\n\n  wrapper?.addEventListener(\"mouseenter\", () => {\n    stopAutoScroll();\n    stopProgress();\n  });\n  wrapper?.addEventListener(\"mouseleave\", () => {\n    startAutoScroll();\n    updateProgress(dots[currentIndex]);\n  });\n\n  let startX = 0;\n\n  wrapper?.addEventListener(\"touchstart\", (e: Event): void => {\n    stopAutoScroll();\n    stopProgress();\n\n    if (!(e instanceof TouchEvent)) return;\n    const touch = e.touches[0];\n    startX = touch.clientX;\n  });\n\n  wrapper?.addEventListener(\"touchend\", (e: Event) => {\n    if (!(e instanceof TouchEvent)) return;\n    const endX = e.changedTouches[0].clientX;\n    const diff = endX - startX;\n\n    if (diff > 50)\n      currentIndex = (currentIndex - 1 + slides.length) % slides.length;\n    else if (diff < -50) currentIndex = (currentIndex + 1) % slides.length;\n    showSlide(currentIndex);\n    resetProgress();\n    startAutoScroll();\n  });\n\n  showSlide(currentIndex);\n  startAutoScroll();\n}\n\ninitSlider();\n\nrefreshButton?.addEventListener(\"click\", () => {\n  initSlider();\n  if (sliderDiv) sliderDiv.style.display = \"flex\";\n  if (dotsContainer) dotsContainer.style.display = \"flex\";\n  if (errorDiv) errorDiv.style.display = \"none\";\n});\n"],"names":["fetcher","url","loaderId","loader","res","err","slideWrapper","wrapper","sliderDiv","dotsContainer","prev","next","errorDiv","refreshButton","initSlider","error","slides","slide","index","div","dot","slidesArray","dots","currentIndex","autoScrollDelay","autoScrollTimer","progressRAF","progressStartTime","progressElapsed","updateProgress","bar","step","timestamp","delta","percent","stopProgress","resetProgress","d","span","showSlide","s","i","startAutoScroll","stopAutoScroll","startX","diff"],"mappings":"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"}