{"version":3,"file":"addCartIcon-DIpckBZX.js","sources":["../../src/scripts/state/cartState.ts","../../src/scripts/utils/addCartIcon.ts"],"sourcesContent":["type CartItem = {\n  productId: number;\n  size: string;\n  additives: string[];\n  quantity: number;\n  priceOld: number;\n  priceNew: number;\n};\n\ntype CartState = {\n  items: CartItem[];\n  totalPriceOld: number;\n  totalPriceNew: number;\n};\n\nconst STORAGE_KEY = \"cartState\";\n\nfunction loadFromLocalStorage(): CartState {\n  const saved = localStorage.getItem(STORAGE_KEY);\n  if (saved) return JSON.parse(saved);\n  return { items: [], totalPriceOld: 0, totalPriceNew: 0 };\n}\n\nfunction saveToLocalStorage(state: CartState): void {\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));\n}\n\nlet state: CartState = loadFromLocalStorage();\n\nfunction recalcTotals() {\n  state.totalPriceOld = state.items.reduce(\n    (sum, item) => sum + item.priceOld * item.quantity,\n    0\n  );\n  state.totalPriceNew = state.items.reduce(\n    (sum, item) => sum + item.priceNew * item.quantity,\n    0\n  );\n}\n\nfunction addItem(newItem: CartItem) {\n  const existing = state.items.find(\n    (item) =>\n      item.productId === newItem.productId &&\n      item.size === newItem.size &&\n      JSON.stringify(item.additives) === JSON.stringify(newItem.additives)\n  );\n\n  if (existing) {\n    existing.quantity += newItem.quantity;\n  } else {\n    state.items.push(newItem);\n  }\n\n  recalcTotals();\n  saveToLocalStorage(state);\n}\n\nfunction clear() {\n  state = { items: [], totalPriceOld: 0, totalPriceNew: 0 };\n  saveToLocalStorage(state);\n}\n\nfunction getItems(): CartItem[] {\n  return state.items;\n}\n\nfunction getTotalPriceOld(): number {\n  return state.totalPriceOld;\n}\n\nfunction getTotalPriceNew(): number {\n  return state.totalPriceNew;\n}\n\nfunction getTotalCount(): number {\n  return state.items.reduce((sum, item) => sum + item.quantity, 0);\n}\n\nexport function useCartState() {\n  return {\n    addItem,\n    clear,\n    getItems,\n    getTotalPriceOld,\n    getTotalPriceNew,\n    getTotalCount,\n  };\n}\n","import { useCartState } from \"../state/cartState\";\nimport { useUserState } from \"../state/userState\";\n\nconst { isLoggedIn } = useUserState();\n\nif (isLoggedIn()) {\n  const { getTotalCount } = useCartState();\n\n  const wrapper = document.querySelector(\"#nav-right\");\n\n  const cartLink = document.createElement(\"a\");\n  cartLink.classList.add(\"link\");\n  cartLink.href = \"cart\";\n  cartLink.innerHTML = `\n    <img src=\"icons/shopping-bag.svg\" alt=\"Shopping cart icon\" />\n    <span>${getTotalCount() > 0 ? getTotalCount() : \"\"}</span>\n  `;\n\n  wrapper?.prepend(cartLink);\n}\n"],"names":["STORAGE_KEY","loadFromLocalStorage","saved","saveToLocalStorage","state","recalcTotals","sum","item","addItem","newItem","existing","clear","getItems","getTotalPriceOld","getTotalPriceNew","getTotalCount","useCartState","isLoggedIn","useUserState","wrapper","cartLink"],"mappings":"4CAeA,MAAMA,EAAc,YAEpB,SAASC,GAAkC,CACzC,MAAMC,EAAQ,aAAa,QAAQF,CAAW,EAC9C,OAAIE,EAAc,KAAK,MAAMA,CAAK,EAC3B,CAAE,MAAO,CAAA,EAAI,cAAe,EAAG,cAAe,CAAA,CACvD,CAEA,SAASC,EAAmBC,EAAwB,CAClD,aAAa,QAAQJ,EAAa,KAAK,UAAUI,CAAK,CAAC,CACzD,CAEA,IAAIA,EAAmBH,EAAA,EAEvB,SAASI,GAAe,CACtBD,EAAM,cAAgBA,EAAM,MAAM,OAChC,CAACE,EAAKC,IAASD,EAAMC,EAAK,SAAWA,EAAK,SAC1C,CAAA,EAEFH,EAAM,cAAgBA,EAAM,MAAM,OAChC,CAACE,EAAKC,IAASD,EAAMC,EAAK,SAAWA,EAAK,SAC1C,CAAA,CAEJ,CAEA,SAASC,EAAQC,EAAmB,CAClC,MAAMC,EAAWN,EAAM,MAAM,KAC1BG,GACCA,EAAK,YAAcE,EAAQ,WAC3BF,EAAK,OAASE,EAAQ,MACtB,KAAK,UAAUF,EAAK,SAAS,IAAM,KAAK,UAAUE,EAAQ,SAAS,CAAA,EAGnEC,EACFA,EAAS,UAAYD,EAAQ,SAE7BL,EAAM,MAAM,KAAKK,CAAO,EAG1BJ,EAAA,EACAF,EAAmBC,CAAK,CAC1B,CAEA,SAASO,GAAQ,CACfP,EAAQ,CAAE,MAAO,CAAA,EAAI,cAAe,EAAG,cAAe,CAAA,EACtDD,EAAmBC,CAAK,CAC1B,CAEA,SAASQ,GAAuB,CAC9B,OAAOR,EAAM,KACf,CAEA,SAASS,GAA2B,CAClC,OAAOT,EAAM,aACf,CAEA,SAASU,GAA2B,CAClC,OAAOV,EAAM,aACf,CAEA,SAASW,GAAwB,CAC/B,OAAOX,EAAM,MAAM,OAAO,CAACE,EAAKC,IAASD,EAAMC,EAAK,SAAU,CAAC,CACjE,CAEO,SAASS,GAAe,CAC7B,MAAO,CACL,QAAAR,EACA,MAAAG,EACA,SAAAC,EACA,iBAAAC,EACA,iBAAAC,EACA,cAAAC,CAAA,CAEJ,CCrFA,KAAM,CAAE,WAAAE,CAAA,EAAeC,EAAA,EAEvB,GAAID,IAAc,CAChB,KAAM,CAAE,cAAAF,CAAA,EAAkBC,EAAA,EAEpBG,EAAU,SAAS,cAAc,YAAY,EAE7CC,EAAW,SAAS,cAAc,GAAG,EAC3CA,EAAS,UAAU,IAAI,MAAM,EAC7BA,EAAS,KAAO,OAChBA,EAAS,UAAY;AAAA;AAAA,YAEXL,EAAA,EAAkB,EAAIA,EAAA,EAAkB,EAAE;AAAA,IAGpDI,GAAS,QAAQC,CAAQ,CAC3B"}