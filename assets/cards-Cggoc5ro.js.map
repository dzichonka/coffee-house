{"version":3,"file":"cards-Cggoc5ro.js","sources":["../../src/types/typeGuards.ts","../../src/scripts/modules/cards.ts"],"sourcesContent":["export function isCategoryType(value: string): value is CategoryType {\n  return [\"coffee\", \"tea\", \"dessert\"].includes(value);\n}\n\nexport function isSizesType(value: string): value is SizesType {\n  return [\"s\", \"m\", \"l\"].includes(value);\n}\n","import { displayModal } from \"./modal\";\nimport { isCategoryType } from \"@/types/typeGuards\";\nimport { fetcher } from \"../utils/fetcher\";\nimport { useUserState } from \"../state/userState\";\n\nconst { isLoggedIn } = useUserState();\n\nconst wrapper: HTMLDivElement | null = document.querySelector(\"#cards\");\nconst tabs: HTMLDivElement[] = Array.from(\n  document.querySelectorAll(\".tab-category\")\n);\nconst refresh: HTMLButtonElement | null = document.querySelector(\"#refresh\");\n\nif (\n  !(wrapper instanceof HTMLDivElement) ||\n  !(refresh instanceof HTMLButtonElement) ||\n  tabs.length === 0\n) {\n  throw new Error(\"No cards elements found\");\n}\n\nlet products: FavoriteProduct[] = [];\n\nlet currentCategory: CategoryType = \"coffee\";\n\nconst isMobile = () => window.innerWidth <= 768;\n\nlet visibleCount: number = isMobile() ? 4 : 8;\n\nasync function fetchProducts() {\n  const { data: res, error } = await fetcher<{\n    data: FavoriteProduct[];\n    message?: string;\n    error?: string;\n  }>(\n    \"https://6kt29kkeub.execute-api.eu-central-1.amazonaws.com/products\",\n    \"#loader\"\n  );\n\n  if (error || !res) {\n    if (wrapper) {\n      wrapper.innerHTML = `<div class=\"error\"></div> <h3>Something went wrong</h3>`;\n    }\n    refresh?.classList.add(\"hidden\");\n    return;\n  }\n\n  products = res?.data ?? [];\n\n  displayCards(currentCategory);\n}\n\nfunction displayCards(category: CategoryType) {\n  if (!wrapper) return;\n  wrapper.innerHTML = \"\";\n  const cards = products.filter((product) => product.category === category);\n  const visibleCards = cards.slice(0, visibleCount);\n\n  visibleCards.forEach((card: ProductType): void => {\n    const cardElement: HTMLDivElement = document.createElement(\"div\");\n    cardElement.classList.add(\"card\");\n    cardElement.innerHTML = `\n      <div class=\"image-container\">\n        <img\n          src=\"images/menu/${card.id}.png\"\n          alt=\"${card.name}\"\n        />\n      </div>\n      <div class=\"description-container\">\n        <div class=\"description\">\n          <h3>${card.name}</h3>\n          <p>${card.description}</p>\n        </div>\n         <div class=\"price-container\">\n${\n  isLoggedIn() && card.discountPrice\n    ? `\n          <h3 class=\"price\">$${card.discountPrice}</h3>\n          <h3 class=\"price__old\">$${card.price}</h3>\n`\n    : `\n          <h3 class=\"price\">$${card.price}</h3>\n`\n}\n        </div>\n      </div>\n      </div>\n    `;\n    wrapper.append(cardElement);\n\n    cardElement.addEventListener(\"click\", (): void => {\n      displayModal(card.id);\n    });\n  });\n\n  function checkRefreshVisibility() {\n    if (!refresh) return;\n    if (cards.length > visibleCards.length) {\n      refresh.classList.remove(\"hidden\");\n    } else {\n      refresh.classList.add(\"hidden\");\n    }\n  }\n  checkRefreshVisibility();\n}\n\ntabs.forEach((tab) => {\n  tab.addEventListener(\"click\", (): void => {\n    tabs.forEach((t) => t.classList.remove(\"active\"));\n    tab.classList.add(\"active\");\n    visibleCount = isMobile() ? 4 : 8;\n\n    const tabValue = tab.dataset.tab;\n    if (!tabValue || !isCategoryType(tabValue)) return;\n    currentCategory = tabValue;\n    displayCards(currentCategory);\n  });\n});\n\nrefresh?.addEventListener(\"click\", () => {\n  visibleCount += 4;\n  displayCards(currentCategory);\n});\n\nlet lastIsMobile = isMobile();\nwindow.addEventListener(\"resize\", (): void => {\n  const nowIsMobile = isMobile();\n  if (nowIsMobile !== lastIsMobile) {\n    displayCards(currentCategory);\n    lastIsMobile = nowIsMobile;\n  }\n});\n\nfetchProducts();\n"],"names":["isCategoryType","value","isLoggedIn","useUserState","wrapper","tabs","refresh","products","currentCategory","isMobile","visibleCount","fetchProducts","res","error","fetcher","displayCards","category","cards","product","visibleCards","card","cardElement","displayModal","checkRefreshVisibility","tab","t","tabValue","lastIsMobile","nowIsMobile"],"mappings":"2KAAO,SAASA,EAAeC,EAAsC,CACnE,MAAO,CAAC,SAAU,MAAO,SAAS,EAAE,SAASA,CAAK,CACpD,CCGA,KAAM,CAAE,WAAAC,CAAA,EAAeC,EAAA,EAEjBC,EAAiC,SAAS,cAAc,QAAQ,EAChEC,EAAyB,MAAM,KACnC,SAAS,iBAAiB,eAAe,CAC3C,EACMC,EAAoC,SAAS,cAAc,UAAU,EAE3E,GACE,EAAEF,aAAmB,iBACrB,EAAEE,aAAmB,oBACrBD,EAAK,SAAW,EAEhB,MAAM,IAAI,MAAM,yBAAyB,EAG3C,IAAIE,EAA8B,CAAA,EAE9BC,EAAgC,SAEpC,MAAMC,EAAW,IAAM,OAAO,YAAc,IAE5C,IAAIC,EAAuBD,IAAa,EAAI,EAE5C,eAAeE,GAAgB,CAC7B,KAAM,CAAE,KAAMC,EAAK,MAAAC,CAAA,EAAU,MAAMC,EAKjC,qEACA,SAAA,EAGF,GAAID,GAAS,CAACD,EAAK,CACbR,IACFA,EAAQ,UAAY,2DAEtBE,GAAS,UAAU,IAAI,QAAQ,EAC/B,MACF,CAEAC,EAAWK,GAAK,MAAQ,CAAA,EAExBG,EAAaP,CAAe,CAC9B,CAEA,SAASO,EAAaC,EAAwB,CAC5C,GAAI,CAACZ,EAAS,OACdA,EAAQ,UAAY,GACpB,MAAMa,EAAQV,EAAS,OAAQW,GAAYA,EAAQ,WAAaF,CAAQ,EAClEG,EAAeF,EAAM,MAAM,EAAGP,CAAY,EAEhDS,EAAa,QAASC,GAA4B,CAChD,MAAMC,EAA8B,SAAS,cAAc,KAAK,EAChEA,EAAY,UAAU,IAAI,MAAM,EAChCA,EAAY,UAAY;AAAA;AAAA;AAAA,6BAGCD,EAAK,EAAE;AAAA,iBACnBA,EAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKVA,EAAK,IAAI;AAAA,eACVA,EAAK,WAAW;AAAA;AAAA;AAAA,EAI7BlB,EAAA,GAAgBkB,EAAK,cACjB;AAAA,+BACyBA,EAAK,aAAa;AAAA,oCACbA,EAAK,KAAK;AAAA,EAExC;AAAA,+BACyBA,EAAK,KAAK;AAAA,CAEzC;AAAA;AAAA;AAAA;AAAA,MAKIhB,EAAQ,OAAOiB,CAAW,EAE1BA,EAAY,iBAAiB,QAAS,IAAY,CAChDC,EAAaF,EAAK,EAAE,CACtB,CAAC,CACH,CAAC,EAED,SAASG,GAAyB,CAC3BjB,IACDW,EAAM,OAASE,EAAa,OAC9Bb,EAAQ,UAAU,OAAO,QAAQ,EAEjCA,EAAQ,UAAU,IAAI,QAAQ,EAElC,CACAiB,EAAA,CACF,CAEAlB,EAAK,QAASmB,GAAQ,CACpBA,EAAI,iBAAiB,QAAS,IAAY,CACxCnB,EAAK,QAASoB,GAAMA,EAAE,UAAU,OAAO,QAAQ,CAAC,EAChDD,EAAI,UAAU,IAAI,QAAQ,EAC1Bd,EAAeD,IAAa,EAAI,EAEhC,MAAMiB,EAAWF,EAAI,QAAQ,IACzB,CAACE,GAAY,CAAC1B,EAAe0B,CAAQ,IACzClB,EAAkBkB,EAClBX,EAAaP,CAAe,EAC9B,CAAC,CACH,CAAC,EAEDF,GAAS,iBAAiB,QAAS,IAAM,CACvCI,GAAgB,EAChBK,EAAaP,CAAe,CAC9B,CAAC,EAED,IAAImB,EAAelB,EAAA,EACnB,OAAO,iBAAiB,SAAU,IAAY,CAC5C,MAAMmB,EAAcnB,EAAA,EAChBmB,IAAgBD,IAClBZ,EAAaP,CAAe,EAC5BmB,EAAeC,EAEnB,CAAC,EAEDjB,EAAA"}